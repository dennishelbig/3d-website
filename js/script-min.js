function is_touch_device4(){var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(e){return window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}var isTouch=is_touch_device4();function throttle(e,t){var r=!1;return function(){r||(e.call(),r=!0,setTimeout((function(){r=!1}),t))}}document.querySelectorAll(".wall").forEach((function(e,t){var r=document.createElement("div"),s=document.createElement("div"),o=document.createElement("img"),n=document.createElement("div"),c=document.createElement("div");r.classList.add("target"),s.classList.add("static-img"),c.classList.add("rect"),n.classList.add("fullscreen"),t<6&&(o.setAttribute("src","img/gif_prev/"+(t+1)+".gif"),o.setAttribute("rel:animated_src","img/gif/"+(t+1)+".gif"),o.setAttribute("rel:auto_play","0"),o.setAttribute("rel:rubbable","0")),e.append(r),e.append(s),e.append(c),e.append(n),s.append(o),r.addEventListener("click",(function(){c.classList.contains("is-active")||(c.classList.add("is-active"),setTimeout((function(){c.classList.remove("is-active")}),100))}))}));var $images=document.querySelectorAll("img"),$rubs=[];$images.forEach((function(e,t){if(/.*\.gif/.test(e.src)){var r=new SuperGif({gif:e});r.load((function(){})),$rubs.push(r)}}));var $body=document.getElementById("body"),$infobox=document.getElementById("info-box"),$coord_x=$infobox.querySelector(".coord-x"),$coord_y=$infobox.querySelector(".coord-y"),$canvas=document.getElementById("canvas"),$square=document.getElementById("square"),$xaxis=document.getElementById("x-axis"),$zaxis=document.getElementById("z-axis"),$targetsCurrent=[],$targetsNotCurrent=[];function collectCurrentTargets(){$targetsCurrent=[document.querySelector(".current-level .level-part-0"),document.querySelector(".current-level .level-part-1"),document.querySelector(".current-level .level-part-2"),document.querySelector(".current-level .level-part-3"),document.querySelector(".current-level .level-part-4"),document.querySelector(".current-level .level-part-5")]}function collectNotCurrentTargets(){($targetsNotCurrent=[document.querySelectorAll(".level:not(.current-level) .level-part-0"),document.querySelectorAll(".level:not(.current-level) .level-part-1"),document.querySelectorAll(".level:not(.current-level) .level-part-2"),document.querySelectorAll(".level:not(.current-level) .level-part-3"),document.querySelectorAll(".level:not(.current-level) .level-part-4"),document.querySelectorAll(".level:not(.current-level) .level-part-5")]).forEach((function(e){e.forEach((function(e){e.classList.remove("hidden")}))}))}collectCurrentTargets(),collectNotCurrentTargets();var currentViewCoords={x:0,y:0};function xLimit(e){return e>360&&(e-=360),e<0&&(e+=360),e}function yLimit(e){return e>90?e=90:e<-90&&(e=-90),e}function updateAxis(e,t){gsap.set($xaxis,{rotateX:t}),gsap.set($zaxis,{rotateZ:1*e})}var roundedCoords={};function roundCoords(){roundedCoords.x=Math.floor(currentViewCoords.x),roundedCoords.y=Math.floor(currentViewCoords.y)}function updateInfo(){$coord_x.innerHTML=roundedCoords.x,$coord_y.innerHTML=roundedCoords.y}function focusX(e){return e>=330||e<30?($targetsCurrent[4].classList.add("hidden"),$targetsCurrent[5].classList.add("hidden"),$targetsCurrent[0].classList.add("hidden"),$targetsCurrent[1].classList.remove("hidden"),$targetsCurrent[1].classList.remove("enable-focus"),$targetsCurrent[2].classList.remove("hidden"),$targetsCurrent[2].classList.add("enable-focus"),$targetsCurrent[3].classList.remove("hidden"),$targetsCurrent[3].classList.remove("enable-focus"),2):e>=30&&e<90?($targetsCurrent[5].classList.add("hidden"),$targetsCurrent[0].classList.add("hidden"),$targetsCurrent[1].classList.add("hidden"),$targetsCurrent[2].classList.remove("hidden"),$targetsCurrent[2].classList.remove("enable-focus"),$targetsCurrent[3].classList.remove("hidden"),$targetsCurrent[3].classList.add("enable-focus"),$targetsCurrent[4].classList.remove("hidden"),$targetsCurrent[4].classList.remove("enable-focus"),3):e>=90&&e<150?($targetsCurrent[0].classList.add("hidden"),$targetsCurrent[1].classList.add("hidden"),$targetsCurrent[2].classList.add("hidden"),$targetsCurrent[3].classList.remove("hidden"),$targetsCurrent[3].classList.remove("enable-focus"),$targetsCurrent[4].classList.remove("hidden"),$targetsCurrent[4].classList.add("enable-focus"),$targetsCurrent[5].classList.remove("hidden"),$targetsCurrent[5].classList.remove("enable-focus"),4):e>=150&&e<210?($targetsCurrent[1].classList.add("hidden"),$targetsCurrent[2].classList.add("hidden"),$targetsCurrent[3].classList.add("hidden"),$targetsCurrent[4].classList.remove("hidden"),$targetsCurrent[4].classList.remove("enable-focus"),$targetsCurrent[5].classList.remove("hidden"),$targetsCurrent[5].classList.add("enable-focus"),$targetsCurrent[0].classList.remove("hidden"),$targetsCurrent[0].classList.remove("enable-focus"),5):e>=210&&e<270?($targetsCurrent[2].classList.add("hidden"),$targetsCurrent[3].classList.add("hidden"),$targetsCurrent[4].classList.add("hidden"),$targetsCurrent[5].classList.remove("hidden"),$targetsCurrent[5].classList.remove("enable-focus"),$targetsCurrent[0].classList.remove("hidden"),$targetsCurrent[0].classList.add("enable-focus"),$targetsCurrent[1].classList.remove("hidden"),$targetsCurrent[1].classList.remove("enable-focus"),0):e>=270&&e<330?($targetsCurrent[3].classList.add("hidden"),$targetsCurrent[4].classList.add("hidden"),$targetsCurrent[5].classList.add("hidden"),$targetsCurrent[0].classList.remove("hidden"),$targetsCurrent[0].classList.remove("enable-focus"),$targetsCurrent[1].classList.remove("hidden"),$targetsCurrent[1].classList.add("enable-focus"),$targetsCurrent[2].classList.remove("hidden"),$targetsCurrent[2].classList.remove("enable-focus"),1):void 0}var brakePoints=[60,120,180,240,300,360],focusBool=null,xIndex=null,focusArray_img={top:21,bottom:-21,left:-27,right:27,isFocus:!1},limit_img={top:21,bottom:-21,left:-27,right:27};function nullX(e){return brakePoints.forEach((function(t,r){e>60&&(e-=60)})),e>30&&(e-=60),e}function processFocus(e,t,r){var s=nullX(t);return e.yAdjustment=s<0?-1*s/10:s/10,r<=e.top-e.yAdjustment&&r>=e.bottom+e.yAdjustment&&s>=e.left&&s<=e.right?e.isFocus=!0:e.isFocus=!1,e}function adjustY(e){return e<0?-1*e/10:e/10}function focusImage(e,t){var r=nullX(e),s=adjustY(r);xIndex=focusX(e),t<=limit_img.top-s&&t>=limit_img.bottom+s&&r>=limit_img.left&&r<=limit_img.right?(document.body.classList.add("background-black"),focusBool=!0):(document.body.classList.remove("background-black"),focusBool=!1),$rubs.forEach((function(e,t){xIndex===t&&!0===focusBool?e.play():e.pause()}))}var positivX,cuttedX,currentTouchX=0,currentTouchY=0,$crossHair=document.querySelector("#cross-hair"),$targets=document.querySelectorAll(".current-level .target");function isOverlapping(){!0!==focusBool||$targets[xIndex].classList.contains("focus")||($targets[xIndex].classList.add("focus"),$targets[xIndex].parentNode.parentNode.classList.add("focus"),$crossHair.classList.add("over")),!0!==focusBool&&($targets[xIndex].classList.remove("focus"),$targets[xIndex].parentNode.parentNode.classList.remove("focus"),$crossHair.classList.remove("over"))}function cutXto10(){positivX!==roundedCoords.x&&(positivX=roundedCoords.x<0?-1*roundedCoords.x:roundedCoords.x,cuttedX=+positivX.toString().split("").pop())}var $compassX=document.querySelector("#compass-x"),$compassViewportX=$compassX.querySelector(".viewport"),$meterX=$compassViewportX.querySelector(".meter");function updateCompass(){cutXto10(),$compassViewportX.style.transform="translateX("+-2*cuttedX+"%)"}function updateView(e,t,r){!0===r?(currentViewCoords.x=currentViewCoords.x+e/10*-1,currentViewCoords.y=currentViewCoords.y+t/10*1):(currentViewCoords.x=currentViewCoords.x+e/10*1,currentViewCoords.y=currentViewCoords.y+t/10*-1),currentViewCoords.x=xLimit(currentViewCoords.x),currentViewCoords.y=yLimit(currentViewCoords.y),focusImage(currentViewCoords.x,currentViewCoords.y),updateAxis(currentViewCoords.x,currentViewCoords.y),roundCoords(),updateInfo(),updateCompass()}function rotateByScroll(e){updateView(e.deltaX,e.deltaY)}function setTouchInput(e){var t=e.changedTouches.item(0);currentTouchX=t.clientX,currentTouchY=t.clientY}function rotateByTouch(e){var t=e.changedTouches.item(0),r=0-currentTouchX+t.clientX,s=0-currentTouchY+t.clientY;currentTouchX=t.clientX,currentTouchY=t.clientY,updateView(r,s,!0)}function rotateByMouse(e){updateView(e.movementX||e.mozMovementX||e.webkitMovementX||0,e.movementY||e.mozMovementY||e.webkitMovementY||0)}function getSrollInput(e){rotateByScroll(e),event.preventDefault()}function getPointerInput(e){rotateByMouse(e),event.preventDefault()}function getTouchInput(e){rotateByTouch(e),event.preventDefault()}$compassViewportX.append($meterX.cloneNode(!0)),$compassViewportX.append($meterX.cloneNode(!0)),$compassViewportX.append($meterX.cloneNode(!0)),$compassViewportX.append($meterX.cloneNode(!0)),$compassViewportX.append($meterX.cloneNode(!0));var $floor=document.querySelector(".level"),$level1=document.querySelector(".level-1"),$level2=document.querySelector(".level-2"),$level3=document.querySelector(".level-3");function focusY(){$canvas.classList.contains("first")?currentViewCoords.y<0&&($canvas.classList.remove("first"),$canvas.classList.add("second"),$level1.classList.remove("current-level"),$level2.classList.add("current-level"),$level3.classList.remove("current-level")):$canvas.classList.contains("second")?currentViewCoords.y>=0?($canvas.classList.add("first"),$canvas.classList.remove("second"),$level1.classList.add("current-level"),$level2.classList.remove("current-level"),$level3.classList.remove("current-level")):($canvas.classList.add("third"),$canvas.classList.remove("second"),$level1.classList.remove("current-level"),$level2.classList.remove("current-level"),$level3.classList.add("current-level")):$canvas.classList.contains("third")&&currentViewCoords.y>=0&&($canvas.classList.remove("third"),$canvas.classList.add("second"),$level1.classList.remove("current-level"),$level2.classList.add("current-level"),$level3.classList.remove("current-level")),$targets=document.querySelectorAll(".current-level .target"),collectCurrentTargets(),collectNotCurrentTargets()}function crosshairLocked(){$body.classList.add("cross-haired"),focusY()}function crosshairUnlocked(){$body.classList.remove("cross-haired")}var targetingThrottled,havePointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;function lockView(){document.pointerLockElement===$crossHair||document.mozPointerLockElement===$crossHair?(console.log("locked"),document.addEventListener("mousemove",getPointerInput,!1),document.addEventListener("mousemove",targetingThrottled,!1),crosshairLocked()):(console.log("unlocked"),document.removeEventListener("mousemove",getPointerInput,!1),document.removeEventListener("mousemove",targetingThrottled,!1),crosshairUnlocked())}!0!==isTouch&&($body.addEventListener("click",(function(){$crossHair.requestPointerLock=$crossHair.requestPointerLock||$crossHair.mozRequestPointerLock||$crossHair.webkitRequestPointerLock,$crossHair.requestPointerLock()})),document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock()),targetingThrottled=throttle(isOverlapping,100),"onpointerlockchange"in document?document.addEventListener("pointerlockchange",lockView,!1):"onmozpointerlockchange"in document&&document.addEventListener("mozpointerlockchange",lockView,!1),document.addEventListener("touchstart",setTouchInput),document.addEventListener("touchmove",getTouchInput),document.addEventListener("touchmove",targetingThrottled,!1),document.addEventListener("touchend",getTouchInput),$canvas.addEventListener("wheel",getSrollInput,!1),$canvas.addEventListener("wheel",targetingThrottled,!1);
//# sourceMappingURL=script-min.js.map